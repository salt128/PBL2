<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>すごろく用サイト</title>
    <style>
        /* 背景を白に変更 */
        body { 
            text-align: center; 
            font-family: 'Helvetica Neue', Arial, sans-serif; 
            background-color: #ffffff; 
            margin: 0;
            padding: 20px;
            color: #333;
        }

        /* スタート画面：サイコロ画像を中央に配置 */
        #start-screen { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            height: 90vh; 
        }
        
        /* 追加：サイコロ画像のサイズ調整 */
        .start-image {
            width: 200px; /* お好みのサイズに調整してください */
            height: auto;
            margin-bottom: 20px;
        }

        #start-screen h1 { 
            font-size: 2.2rem; 
            color: #333;
            margin-bottom: 30px;
        }

        .start-btn { 
            padding: 18px 50px; font-size: 1.8rem; 
            background-color: #ed4264; 
            color: #ffffff; 
            border: none; border-radius: 50px; cursor: pointer; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
            transition: 0.3s; font-weight: bold;
        }
        .start-btn:hover { transform: translateY(-3px); box-shadow: 0 6px 20px rgba(0,0,0,0.15); }
        .start-btn:disabled { background-color: #ccc; color: #999; }

        /* メイン画面 */
        #main-content { display: none; padding-top: 20px; }

        /* カードのサイズ設定（2倍サイズ） */
        .card-container { display: flex; justify-content: center; gap: 40px; margin-bottom: 30px; flex-wrap: wrap; }
        .card { 
            width: 320px; 
            height: 440px; 
            border-radius: 25px; 
            cursor: pointer; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.1); 
            background-size: cover; 
            background-position: center; 
            transition: 0.3s; 
            border: 1px solid #eee;
        }
        .card:hover { transform: scale(1.03); box-shadow: 0 12px 30px rgba(0,0,0,0.15); }
        
        .red { background-image: url('赤マス用カード.png'); }
        .yellow { background-image: url('黄マス用カード.png'); }

        /* 表示エリア */
        #display-box { 
            background: #f9f9f9; 
            padding: 30px; 
            border-radius: 25px; 
            min-height: 250px; 
            max-width: 600px; 
            margin: 0 auto; 
            border: 1px solid #eee;
        }
        
        #timer-display { font-size: 2.5rem; color: #e74c3c; font-weight: bold; margin-bottom: 15px; }

        .quiz-btns { display: none; justify-content: center; gap: 30px; margin-top: 25px; }
        .ox-btn { font-size: 2.5rem; width: 80px; height: 80px; border-radius: 50%; border: none; cursor: pointer; color: white; }
        .maru { background-color: #2ecc71; }
        .batsu { background-color: #e74c3c; }

        /* 終了ボタン */
        .quit-btn { 
            margin-top: 40px; padding: 12px 30px; background: none; 
            color: #999; border: 1px solid #ccc; border-radius: 20px; 
            cursor: pointer; font-size: 0.9rem; transition: 0.3s;
        }
        .quit-btn:hover { background: #eee; color: #333; }
    </style>
</head>
<body>

    <div id="start-screen">
        <img src="Back.png" alt="Dice" class="start-image">
        <h1>すごろく用サイト</h1>
        <button id="start-button" class="start-btn" onclick="enterApp()" disabled>読み込み中...</button>
    </div>

    <div id="main-content">
        <h2 style="margin-bottom: 30px;">カードを選んでね</h2>
        <div class="card-container">
            <div class="card red" onclick="startQuiz()"></div>
            <div class="card yellow" onclick="showDiscussion()"></div>
        </div>

        <div id="display-box">
            <div id="timer-display"></div>
            <p id="topic-text" style="font-weight:bold; font-size:1.3rem;">準備はいいかな？</p>
            <div id="quiz-area" class="quiz-btns">
                <button class="ox-btn maru" onclick="checkAnswer(true)">○</button>
                <button class="ox-btn batsu" onclick="checkAnswer(false)">×</button>
            </div>
            <div id="result"></div>
        </div>

        <button class="quit-btn" onclick="quitApp()">ゲームを終了する</button>
    </div>

    <script>
        let quizStock = [];
        let discussionStock = [];
        let countdown;
        const GAS_URL = "https://script.google.com/macros/s/AKfycbxjTo8KY7NhO3HpgSiLto-x4rF2NNOqTG11AK7GShyVrLFe8-ige0C8BaCyx5IqCoFg/exec";

        // シャッフル関数
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        window.onload = async () => {
            try {
                const response = await fetch(GAS_URL);
                const data = await response.json();
                quizStock = data.quizzes;
                discussionStock = data.discussions;
                shuffle(quizStock);
                shuffle(discussionStock);
                document.getElementById('start-button').innerText = "スタート";
                document.getElementById('start-button').disabled = false;
            } catch (e) {
                console.error(e);
                alert("データの取得に失敗しました。");
            }
        };

        function enterApp() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
        }

        function quitApp() {
            if (confirm("本当に終了しますか？（スタート画面に戻ります）")) {
                location.reload();
            }
        }

        function startTimer(seconds, onComplete) {
            clearInterval(countdown);
            let timeLeft = seconds;
            const timerDiv = document.getElementById('timer-display');
            timerDiv.style.display = "block";
            timerDiv.innerText = `残り: ${timeLeft}秒`;
            timerDiv.style.color = "#e74c3c";

            countdown = setInterval(() => {
                timeLeft--;
                if (timeLeft > 0) {
                    timerDiv.innerText = `残り: ${timeLeft}秒`;
                } else {
                    clearInterval(countdown);
                    timerDiv.innerText = "0秒（終了）";
                    timerDiv.style.color = "#7f8c8d";
                    onComplete();
                }
            }, 1000);
        }

        function startQuiz() {
            if (quizStock.length === 0) return alert("すべてのクイズが終了しました！");
            document.getElementById('result').innerText = "";
            document.getElementById('quiz-area').style.display = "flex";
            const quiz = quizStock.pop();
            window.currentQuiz = quiz;
            document.getElementById('topic-text').innerText = "【クイズ】\n" + quiz.q;
            startTimer(30, () => {
                document.getElementById('quiz-area').style.display = "none";
                document.getElementById('result').innerText = "⏰ 時間切れ！";
            });
        }

        function showDiscussion() {
            if (discussionStock.length === 0) return alert("すべてのお題が終了しました！");
            document.getElementById('quiz-area').style.display = "none";
            document.getElementById('result').innerText = "";
            const topic = discussionStock.pop();
            document.getElementById('topic-text').innerText = "【お題】\n" + topic;
            startTimer(30, () => {
                document.getElementById('result').innerText = "⏰ 終了！自分の意見は言えたかな？言えたら３マス進もう";
            });
        }

        function checkAnswer(userAnswer) {
            clearInterval(countdown);
            const isCorrect = userAnswer === window.currentQuiz.a;
            document.getElementById('result').innerText = (isCorrect ? "⭕️ 正解！" : "❌ 不正解…") + "\n" + window.currentQuiz.comment;
            document.getElementById('result').style.color = isCorrect ? "#2ecc71" : "#e74c3c";
            document.getElementById('quiz-area').style.display = "none";
        }
    </script>
</body>
</html>

